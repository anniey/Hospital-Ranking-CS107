---
title: "HospitalRankings"
author: "Michael Zelenetz, Xiojing Yang"
date: "April 20, 2016"
output: html_document
---

Load data from local file:
```{r}
library(dplyr)
library(tidyr)
library(ggplot2)
library(broom)
library(knitr)
#cost sets
paymentandvalue <- read.csv("https://raw.githubusercontent.com/anniey/Hospital-Ranking-CS107/master/Raw%20Data/Payment_and_value_of_care_-_Hospital.csv") #national
inpatientcost <- read.csv("https://raw.githubusercontent.com/anniey/Hospital-Ranking-CS107/master/Raw%20Data/Hospital_Inpatient_Cost_Transparency__Beginning_2009.csv") #NYS

#risk of badness sets
PCIbyhospital <- read.csv("https://raw.githubusercontent.com/anniey/Hospital-Ranking-CS107/master/Raw%20Data/Cardiac_Surgery_and_Percutaneous_Coronary_Interventions_by_Hospital___Beginning_2008.csv") #NYS
hospitalinfection <- read.csv("https://raw.githubusercontent.com/anniey/Hospital-Ranking-CS107/master/Raw%20Data/Hospital-Acquired_Infections__Beginning_2008.csv") #NYS
complicationshospital <- read.csv("https://raw.githubusercontent.com/anniey/Hospital-Ranking-CS107/master/Raw%20Data/Readmissions_Complications_and_Deaths_-_Hospital.csv") #national

#service
hcahps <- read.csv("https://raw.githubusercontent.com/anniey/Hospital-Ranking-CS107/master/Raw%20Data/hcahps.csv") #NYS
timely <- read.csv("https://raw.githubusercontent.com/anniey/Hospital-Ranking-CS107/master/Raw%20Data/Timely_and_Effective_Care_-_Hospital.csv") #national

#readmisisons
readmission <- read.csv("https://raw.githubusercontent.com/anniey/Hospital-Ranking-CS107/master/Raw%20Data/Hospital_Readmissions_Reduction_Program.csv") #national 
```

##Wrangling
Limit Data Sets to NYS only:
```{r}
paymentandvalue <- paymentandvalue %>% filter(State=="NY")
paymentandvalue <- paymentandvalue %>% filter(State=="NY")
complicationshospital <- complicationshospital %>% filter(State=="NY")
hcahps <- hcahps %>% filter(State=="NY")
timely <- timely %>% filtexzr(State=="NY")
readmission <- readmission %>% filter(State=="NY")
mortality <- mortality %>% filter(State=="NY")
```

Combine all the datasets that use Provider ID and Facility ID, respectively
```{r}

#first, join the datasets with providerIDs
providerID_data <- complicationshospital %>%
  select(c(Provider.ID, Hospital.Name, Measure.Name, Measure.ID, Compared.to.National, Denominator, Score, Lower.Estimate, Higher.Estimate, Location))

providerID_data <- hcahps %>%
  select(c(Provider.ID, HCAHPS.Measure.ID, HCAHPS.Question, Patient.Survey.Star.Rating, HCAHPS.Answer.Percent, HCAHPS.Linear.Mean.Value)) %>%
  transform(Provider.ID = factor(Provider.ID)) %>%
  right_join(providerID_data, by = "Provider.ID")

providerID_data <- paymentandvalue %>%
  select(c(Provider.ID, Payment.measure.ID, Payment.measure.name, Payment.category, Denominator, Payment, Value.of.care.display.ID, Value.of.care.display.name, Value.of.care.category)) %>%
  right_join(providerID_data, by = "Provider.ID")

#split the coordinates from the location column. we will use it later to help ID hospitals with varying name conventions btw the provider and facility dataset
providerID_data <- providerID_data %>%
  separate(Location, into = c("Location", "Location.1"), sep = "\\(")
  
#next join all the datasets with facility ID (remove 2008 from hospitalinfection)
facilityID_data <- hospitalinfection %>%
  select(-c(Hospital.Name)) %>%
  filter(Year > 2008) %>%
  right_join(inpatientcost, by = c("Facility.Id", "Year"))

colnames(PCIbyhospital)[1] <- "Facility.Id"
colnames(PCIbyhospital)[6] <- "Year"

temp <- PCIbyhospital %>%
  select(-c(Detailed.Region, Region, Hospital.Name)) %>%
  transform(Year = as.numeric(levels(Year))[Year]) %>%
  filter(Year %in% c("2010", "2011", "2012"))

facilityID_data <- facilityID_data %>%
  filter(Year > 2009) %>%
  left_join(temp, by = c("Facility.Id", "Year"))

#clean case convention and column name
facilityID_data$Facility.Name <- toupper(facilityID_data$Facility.Name)

colnames(facilityID_data)[13] <- c("Hospital.Name")
```


Now let's try to join the ProviderID dataset with the FacilityID dataset using the Hospital/Facility Name. First, we need to clean up some of the varying naming conventions between the two datasets. We will use ProviderID as the convention since it has the shorter list

```{r}
#find the hospital names that are slightly different between the datasets

facilityID_data$Hospital.Name <- as.character(facilityID_data$Hospital.Name)
providerID_data$Hospital.Name <- as.character(providerID_data$Hospital.Name)

FacilityNames <- facilityID_data %>%
  select(Hospital.Name, Location.1) %>%
  as.data.frame() %>%
  unique()

HospitalNames <- providerID_data %>%
  select(Hospital.Name, Location.1) %>%
  as.data.frame() %>%
  unique()

#merge the tables and find where there is unmerged rows
ProblemNames <- merge(FacilityNames, HospitalNames, by = "Hospital.Name", all = TRUE)

```


Quickly scanning the list of merged names, we notice that a common difference in convention between the datasets is the use of "INC" vs ", INC". Let's update FacilityID from "INC" to ", INC".
```{r}

#Update FacilityID's uses "INC" to match ProviderID's ", INC"
facilityID_data$Hospital.Name <- gsub(" INC", ", INC", facilityID_data$Hospital.Name)

#rerun the merged datasets
FacilityNames <- facilityID_data %>%
  select(Hospital.Name, Location.1) %>%
  as.data.frame() %>%
  unique()

#merge the tables and find where there is unmerged rows
ProblemNames <- merge(FacilityNames, HospitalNames, by = "Hospital.Name", all = TRUE)
```

It also looks like the facility database has separate IDs for different divisions of a hospital provider. Let's remap all these divisions to the parent provider
```{r}

#rename Catskill to remove from further cleaning
facilityID_data$Hospital.Name <- gsub("CATSKILL REGIONAL MEDICAL CENTER - G. HERMANN SITE", "CATSKILL REGIONAL MEDICAL CENTER G HERMANN SITE", facilityID_data$Hospital.Name)

#remove division name following -
facilityID_data$Hospital.Name <- gsub(" - [A-z ]*", "", facilityID_data$Hospital.Name)

#refilter uniques
FacilityNames <- facilityID_data %>%
  select(Hospital.Name, Location.1) %>%
  as.data.frame()

FacilityNames <- FacilityNames[!duplicated(FacilityNames[,1]),]

#merge the tables and find where there is unmerged rows
ProblemNames <- full_join(FacilityNames, HospitalNames, by = "Hospital.Name")

```

We still have a couple more manual changes to make

```{r}

#create table remapping facility name to hospital name
facility_orig = c("ADIRONDACK MEDICAL CENTER-SARANAC LAKE SITE", "BROOKHAVEN MEMORIAL HOSPITAL MEDICAL CENTER INC", "BROOKLYN HOSPITAL CENTER AT DOWNTOWN CAMPUS", "CATSKILL REGIONAL MEDICAL CENTER - G. HERMANN SITE", "CHAMPLAIN VALLEY PHYSICIANS HOSPITAL MEDICAL CENTER", "CLIFTON-FINE HOSPITAL", "FAXTON-ST LUKES HEALTHCARE ST LUKES DIVISION", "FAXTON-ST LUKES HEALTHCARE FAXTON DIVISION", "JOHN T MATHER MEMORIAL HOSPITAL OF PORT JEFFERSON NEW YORK, INC", "MARGARETVILLE HOSPITAL", "MONTEFIORE", "MONTEFIORE MED CENTER", "MONTEFIORE MEDICAL CENTER& LUCY MOSES DIV", "MOUNT VERNON HOSPITAL", "MOUNT ST MARYS HOSPITAL AND HEALTH CENTER", "NEW YORK COMMUNITY HOSPITAL OF BROOKLYN,, INC", "NEW YORK PRESBYTERIAN HOSPITAL", "RIVER HOSPITAL,, INC.", "ROME MEMORIAL HOSPITAL,, INC", "SCHUYLER HOSPITAL", "SOLDIERS AND SAILORS MEMORIAL HOSPITAL OF YATES, INC", "ST JOHNS EPISCOPAL HOSPITAL SO SHORE", "ST JOSEPHS HOSPITAL", "ST JOSEPHS HOSPITAL HEALTH CENTER", "ST JOSEPH'S MC-ST VINCENTS WESTCHESTER DIVISION", "ST LUKE'S CORNWALL HOSPITAL/NEWBURGH", "ST LUKES ROOSEVELT HOSPITAL", "ST LUKES ROOSEVELT HOSPITAL CENTER", "ST PETERS HOSPITAL", "ST. JOSEPH HOSPITAL", "STATEN ISLAND UNIVERSITY HOSP-NORTH", "STATEN ISLAND UNIVERSITY HOSP-SOUTH", "UNITED HEALTH SERVICES HOSPITALS, INC.", "UNITED MEMORIAL MEDICAL CENTER BANK STREET CAMPUS", "UNITED MEMORIAL MEDICAL CENTER NORTH STREET CAMPUS", "UNIVERSITY HOSPITAL", "UNIVERSITY HOSPITAL OF BROOKLYN", "UNIVERSITY HOSPITAL SUNY HEALTH SCIENCE CENTER", "WOMANS CHRISTIAN ASSOC HOSPITAL", "WOODHULL MEDICAL & MENTAL HEALTH CENTER")

facility_new = c("ADIRONDACK MEDICAL CENTER", "BROOKHAVEN MEMORIAL HOSPITAL MEDICAL CENTER", "BROOKLYN HOSPITAL CENTER", "CATSKILL REGIONAL MEDICAL CENTER - G HERMANN SITE", "CHAMPLAIN VALLEY PHYSICIANS HOSPITAL MEDICAL CTR", "CLIFTON FINE HOSPITAL", "FAXTON-ST LUKE'S HEALTHCARE", "FAXTON-ST LUKE'S HEALTHCARE", "JOHN T MATHER MEMORIAL HOSPITAL OF PORT JEFFERSON", "MARGARETVILLE MEMORIAL HOSPITAL", "MONTEFIORE MEDICAL CENTER", "MONTEFIORE MEDICAL CENTER", "MONTEFIORE MEDICAL CENTER", "MONTEFIORE MOUNT VERNON HOSPITAL", "MOUNT ST MARY'S HOSPITAL AND HEALTH CENTER", "NEW YORK COMMUNITY HOSPITAL OF BROOKLYN, INC.", "NEW YORK-PRESBYTERIAN HOSPITAL", "RIVER HOSPITAL, INC", "ROME MEMORIAL HOSPITAL, INC", "SCHUYLER HOSPITAL, INC", "SOLDIERS AND SAILORS MEMORIAL HOSPITAL OF YATES", "ST JOHN'S EPISCOPAL HOSPITAL AT SOUTH SHORE", "ST JOSEPH'S HOSPITAL, INC", "ST JOSEPH'S HOSPITAL HEALTH CENTER", "ST JOSEPH'S MEDICAL CENTER", "ST LUKE'S CORNWALL HOSPITAL", "ST LUKE'S ROOSEVELT HOSPITAL","ST LUKE'S ROOSEVELT HOSPITAL CENTER", "ST PETER'S HOSPITAL", "ST JOSEPH HOSPITAL", "STATEN ISLAND UNIVERSITY HOSPITAL", "STATEN ISLAND UNIVERSITY HOSPITAL", "UNITED HEALTH SERVICES HOSPITALS, INC", "UNITED MEMORIAL MEDICAL CENTER", "UNITED MEMORIAL MEDICAL CENTER", "UNIVERSITY HOSPITAL (STONY BROOK)", "UNIVERSITY HOSPITAL OF BROOKLYN (DOWNSTATE)", "UNIVERSITY HOSPITAL S U N Y HEALTH SCIENCE CENTER", "WOMAN'S CHRISTIAN ASSOCIATION HOSPITAL", "WOODHULL MEDICAL AND MENTAL HEALTH CENTER")

#renaming table
remapped_names <- data.frame("Facility Name" = facility_orig, "Provider Name" = facility_new, stringsAsFactors = FALSE)

#rename the hospitals in the facilityID_data
facilityID_data$Hospital.Name <- sapply(facilityID_data$Hospital.Name, function(x){
  ifelse(x %in% remapped_names$Facility.Name, remapped_names[facility_orig == x, 2], x)
})



```

Michael's relationship exploration space

I expected cost to improve with the number of cases seen, does it?
```{r}
PN <- providerID_data %>%
  filter(Payment.measure.ID=="PAYM_30_PN") %>%
  select(Provider.ID, Denominator.x, Payment, Payment.measure.ID) %>%
  na.omit(PN) %>%
  filter(Denominator.x != "Not Available")
PN <- PN[!duplicated(PN), ]
ggplot(PN, aes(Denominator.x, Payment)) + geom_point()

AMI <- providerID_data %>%
  filter(Payment.measure.ID=="PAYM_30_AMI") %>%
  select(Provider.ID, Denominator.x, Payment, Payment.measure.ID) %>%
  na.omit(AMI) %>%
  filter(Denominator.x != "Not Available")
AMI <- AMI[!duplicated(AMI), ]
ggplot(AMI, aes(Denominator.x, Payment)) + geom_point()

HF <- providerID_data %>%
  filter(Payment.measure.ID=="PAYM_30_HF") %>%
  select(Provider.ID, Denominator.x, Payment, Payment.measure.ID) %>%
  na.omit(HF) %>%
  filter(Denominator.x != "Not Available")
HF <- HF[!duplicated(HF), ]
ggplot(HF, aes(Denominator.x, Payment)) + geom_point()
```
No, it does not.

```{r}
library(scales)
PCI <- inpatientcost %>% 
  filter(Year==2010) %>%
  filter(APR.DRG.Description=="Heart Failure")%>%
  filter(APR.Severity.of.Illness.Code==1)
ggplot(PCI, aes(Discharges, Mean.Charge)) + geom_point(color=PCI$APR.Severity.of.Illness.Code) + geom_smooth(method=lm) + scale_x_continuous(trans=log2_trans())

PCI <- inpatientcost %>% 
  filter(Year==2010) %>%
  filter(APR.DRG.Description=="Heart Failure")%>%
  filter(APR.Severity.of.Illness.Code==2)
ggplot(PCI, aes(Discharges, Mean.Charge)) + geom_point(color=PCI$APR.Severity.of.Illness.Code) + geom_smooth(method=lm) + scale_x_continuous(trans=log2_trans())

PCI <- inpatientcost %>% 
  filter(Year==2010) %>%
  filter(APR.DRG.Description=="Heart Failure")%>%
  filter(APR.Severity.of.Illness.Code==3)
ggplot(PCI, aes(Discharges, Mean.Charge)) + geom_point(color=PCI$APR.Severity.of.Illness.Code) + geom_smooth(method=lm) + scale_x_continuous(trans=log2_trans())
```
Severity does not change costs, neither does number of cases. 


```{r}
#temp <- as.data.frame(unique(providerID_data$Provider.ID))
#temp2 <- facilityID_data[!duplicated(facilityID_data$Hospital.Name),]
```

```{r}
readmissionInfection <- filter(readmission, Measure.Name=="READM-30-COPD-HRRP") %>% 
  select(Hospital.Name, Provider.Number, Number.of.Readmissions, Number.of.Discharges)

#convert to correct type
readmissionInfection[, 3] <- as.numeric(as.character( readmissionInfection[, 3] ))
readmissionInfection[, 4] <- as.numeric(as.character( readmissionInfection[, 4] ))
 #omit NAs
na.omit(readmissionInfection)

readmissionInfection <- mutate(readmissionInfection, readmissionRate= `Number.of.Readmissions`/`Number.of.Discharges`)

#time in ED
temp <- timely %>%
  filter(Measure.ID=="ED_1b") #Median time from emergency department arrival to emergency department departure for admitted emergency department patients

temp <- left_join(temp, readmissionInfection, by= "Hospital.Name") %>%
  select(Hospital.Name, Measure.ID, Score, Sample, readmissionRate)
ggplot(temp, aes(x=temp$readmissionRate, y= temp$Score)) + geom_point() + xlab("Readmission Rate") + ylab("ED Wait Times (for admitted patients)")
```



```{r}
#THIS IS DRIVING ME CRAZY
#Box plot Scores
complicationshospital <- as.data.frame(complicationshospital)
temp <- select(complicationshospital, Hospital.Name, Score, Measure.Name)
temp <- temp$Score %>% gsub("Not Available", NA)
```


Annie's data exploration space

The first hypothesis we will test is whether number of cases seen by a hospital impacts quality of care or cost.
```{r}

#clean the data
PV <- paymentandvalue %>%
  select(Provider.ID, Denominator, Payment, Payment.measure.ID, Value.of.care.category) %>%
  na.omit() %>%
  filter(Denominator != "Not Available")

#change payment and denominator into numeric
PV$Payment <- sub('\\$','', as.character(levels(PV$Payment))[PV$Payment]) %>%
  as.numeric()

PV$Denominator <- sub('\\,','', as.character(levels(PV$Denominator))[PV$Denominator]) %>%
  as.numeric()


#plot cost and number of cases a hospital sees
ggplot(PV, aes(Denominator, Payment)) + 
  geom_point() +
  facet_wrap(~Payment.measure.ID, scales = "free_x") +
  xlab("Case count")

```

The number of cases does not appear to be correlated with payment. This suggests that, contrary to expectation, hospitals that see more of a case may not actually have an advantage in scalibility to reduce costs.

Let's now see whether value of care, as defined by mortality and payment intersection, is impacted by the number of cases seen.

```{r}
#let's now check number of cases and value of care
PV %>%
  ggplot(aes(Value.of.care.category, Denominator)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  ylab("Number of Cases")

#let's check heart disease in particular
PV %>% filter(Payment.measure.ID == "PAYM_30_HF") %>%
  ggplot(aes(Value.of.care.category, Denominator)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  ylab("Number of Cases")


```

From the boxplots, we can see that number of cases seen does not appear to vary much between average mortality and worse mortality outcomes. However, it does appear that hospitals with better mortality tend to have seen more cases.

Let's focus on just mortality, ignoring the payment dimension, and observe the impact of cases there.

```{r}

#bucket the mortality rates, ignoring payment
PV <- PV %>%
  mutate(Care.Cat = ifelse(grepl("Better mortality", Value.of.care.category), "Better Mortality", 
                           ifelse(grepl("Average mortality", Value.of.care.category), "Average Mortality", "Worse mortality")))

#let's plot a boxplot of the number of cases by group
PV %>%
  ggplot(aes(Care.Cat, Denominator)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  ylab("Number of Cases") +
  facet_wrap(~Payment.measure.ID, scales = "free_x")

```

In ignoring the payment categories and focusing on just average vs. better mortality, we can see that mortality does seem to be better at hospitals that observe more cases for all three types of illnesses. Let us see if there is enough 

```{r}
library(caret)
set.seed(1)
#turn character into numeric
PV <- mutate(PV, Care.Cat = ifelse(grepl("Better mortality", Value.of.care.category), 3, 
                           ifelse(grepl("Average mortality", Value.of.care.category), 2, 1)))


#create train and test sets
inTrain <- createDataPartition(y = PV$Care.Cat, p = 0.8)
train_set <- slice(PV, inTrain$Resample1)
test_set <- slice(PV, -inTrain$Resample1)

#fit the data
fit <- glm(Care.Cat ~ Denominator, data=train_set)
pred <- predict(fit, newdata = test_set, type = "response")
tab <- table(pred = round(pred), truth = test_set$Care.Cat)

tab

```

From the table of results above, we can see that while there may appear to be some difference in number of cases seen between the three categories of mortality, the difference is not great enough for number of cases to be used as a predictor of mortality. That being said, the small size of the dataset and the arbitrary cutoff may be at play here.

Let's see what happens when we leverage another database that has actual mortality rates.

```{r}
CH <- complicationshospital %>%
  select(Measure.ID, Denominator, Score)

#change score and denominator to number
CH$Denominator <- as.numeric(as.character(CH$Denominator))
CH$Score <- as.numeric(as.character(CH$Score))

#let's look at the relationship for HF only
CH %>%
  filter(Measure.ID == "MORT_30_HF") %>%
  ggplot(aes(Denominator, Score)) +
  geom_point() +
  geom_smooth()
```

It looks like there is a slightly increase in mortality rate when the number of cases increase, but then it drops off as the number of cases continue to grow. Let's now explore additional measures such as mortality rate for AMI and Strokes.

```{r}
#let's look at the relationship for AMI and STK
CH %>%
  filter(Measure.ID %in% c("MORT_30_HF", "MORT_30_AMI", "MORT_30_STK")) %>%
  ggplot(aes(Denominator, Score, colour = Measure.ID)) +
  geom_point() +
  geom_smooth() 

```

The drop in mortality rate is even more pronounced for AMI.

Let's see what happens when we try to fit a regression to number of cases and mortality rate of AMI and HF.

```{r}

CH_HF <- CH %>%
  filter(Measure.ID == "MORT_30_HF") %>%
  na.omit()
  
CH_AMI <- CH %>%
  filter(Measure.ID == "MORT_30_AMI") %>%
  na.omit()

res_HF <- CH %>%
  filter(Measure.ID %in% c("MORT_30_HF")) %>%
  lm(Score ~ Denominator, data = .) %>%
  tidy(conf.int = TRUE)

res_AMI <- CH %>%
  filter(Measure.ID %in% c("MORT_30_AMI")) %>%
  lm(Score ~ Denominator, data = .) %>%
  tidy(conf.int = TRUE)

kable(res_HF)
kable(res_AMI)
```

From the above, we can see that with each additional case of HF, a hospital's rate of mortality decreases between 0.01% to 0.02%. For AMI, the rate of decrease is even higher at 0.01% to 0.04%. 

Another database that has mortality rating is PCIbyhospital. Let's see if we can find the same relationship there.

```{r}

#removing observed mortality rate of 0
PCI_mort <- PCIbyhospital %>%
  filter(Procedure == "All PCI", Hospital.Name != "NYS - All Hospitals", Observed.Mortality.Rate >0) %>%
  select(Number.of.Cases, Observed.Mortality.Rate, Risk.Adjusted.Mortality.Rate)

#plot Risk Adjusted rates
PCI_mort %>%
  ggplot(aes(Number.of.Cases, Risk.Adjusted.Mortality.Rate)) +
  geom_point() +
  geom_smooth()

#plot observed rate
PCI_mort %>%
  ggplot(aes(Number.of.Cases, Observed.Mortality.Rate)) +
  geom_point() +
  geom_smooth()

```

We see a fairly sharp drop in mortality rate that plateaus once the number of cases surpasses 500. This appears to apply to both the observed and risk adjusted mortality rate. Let's now fit a regression to number of cases against the two rates.

```{r}

res_Obs <- PCI_mort %>%
  lm(Risk.Adjusted.Mortality.Rate ~ Number.of.Cases, data = .) %>%
  tidy(conf.int = TRUE)

res_Adj <- PCI_mort %>%
  lm(Observed.Mortality.Rate ~ Number.of.Cases, data = .) %>%
  tidy(conf.int = TRUE)

kable(res_Obs)
kable(res_Adj)
```

We see about the same relationship of 0.01%-0.04% decrease in mortality rate for each additional case seen.

Now, let us move on to examining severity's relationship with cost and number of cases

```{r}
Severity<- inpatientcost %>% 
  filter(APR.DRG.Description=="Heart Failure")

#change charge to numeric
Severity$Mean.Charge <- sub('\\$','', as.character(levels(Severity$Mean.Charge))[Severity$Mean.Charge]) %>%
  as.numeric()

#boxplot of charge by severity
Severity %>%
  ggplot(aes(APR.Severity.of.Illness.Description, Mean.Charge)) +
  geom_boxplot()

```

As expected, it appears extreme cases have higher charges than the other cases.

Let's see if there is a relationship between dischage and mean cost in this dataset, which we could not find in the prior paymentandvalue one.

```{r}

#boxplot of charge by severity
Severity %>%
  ggplot(aes(Discharges, Mean.Charge)) +
  geom_point() +
  facet_wrap(~APR.Severity.of.Illness.Description, scales = "free_x")

```

Here, we reaffirm our earlier observation that number of cases does not appear to impact individual cost.